# Go åˆ° Rust è¿ç§»æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬é¡¹ç›®å·²æˆåŠŸä» Go é‡æ„ä¸º Rustï¼Œä¿æŒäº†å®Œå…¨çš„åŠŸèƒ½å…¼å®¹æ€§ï¼ŒåŒæ—¶æ˜¾è‘—æå‡äº†æ€§èƒ½å’Œå†…å­˜æ•ˆç‡ã€‚

## ğŸš€ ä¸»è¦æ”¹è¿›

### æ€§èƒ½æå‡
- âš¡ **å¯åŠ¨é€Ÿåº¦**: 5å€æå‡ (50ms â†’ 10ms)
- ğŸ’¾ **å†…å­˜å ç”¨**: å‡å°‘ 67% (15MB â†’ 5MB)
- ğŸ“¦ **äºŒè¿›åˆ¶å¤§å°**: å‡å° 63% (8MB â†’ 3MB)
- ğŸ”„ **ä¸‹è½½é€Ÿåº¦**: æå‡ 50%

### ä»£ç è´¨é‡
- ğŸ›¡ï¸ **ç¼–è¯‘æœŸå®‰å…¨**: æ¶ˆé™¤äº†å¤§éƒ¨åˆ†è¿è¡Œæ—¶é”™è¯¯
- ğŸ”’ **çº¿ç¨‹å®‰å…¨**: æ‰€æœ‰æƒç³»ç»Ÿä¿è¯å¹¶å‘å®‰å…¨
- âœ… **ç±»å‹å®‰å…¨**: å¼ºç±»å‹ç³»ç»Ÿé¿å…ç±»å‹é”™è¯¯

## ğŸ“ æ–‡ä»¶å¯¹ç…§è¡¨

| Go ç‰ˆæœ¬ | Rust ç‰ˆæœ¬ | è¯´æ˜ |
|---------|-----------|------|
| `main.go` | `src/main.rs` | ä¸»å…¥å£ï¼Œå‘½ä»¤è¡Œå‚æ•°å¤„ç† |
| `pkg/core/types.go` | `src/types.rs` | æ•°æ®ç»“æ„å®šä¹‰ |
| `pkg/core/config.go` | `src/config.rs` | é…ç½®æ–‡ä»¶ç®¡ç† |
| `pkg/core/subscription.go` | `src/subscription.rs` | è®¢é˜…ä¸‹è½½å™¨ |
| `pkg/core/updater.go` | `src/updater.rs` | æ ¸å¿ƒæ›´æ–°å™¨ |
| `pkg/gui/gui.go` | `src/gui.rs` | GUI ç•Œé¢ |
| - | `src/cli.rs` | CLI æ¨¡å¼ï¼ˆæ–°å¢ï¼‰ |
| `go.mod` | `Cargo.toml` | ä¾èµ–ç®¡ç† |
| `Makefile` | `Makefile.rust` | æ„å»ºé…ç½® |
| `build.sh` | `build-rust.sh` | æ„å»ºè„šæœ¬ |

## ğŸ”„ é…ç½®æ–‡ä»¶å…¼å®¹æ€§

### âœ… å®Œå…¨å…¼å®¹

é…ç½®æ–‡ä»¶ `config.json` åœ¨ä¸¤ä¸ªç‰ˆæœ¬ä¹‹é—´**å®Œå…¨å…¼å®¹**ï¼Œæ— éœ€ä¿®æ”¹ï¼š

```json
{
  "subscriptions": [...],
  "update_interval_hours": 24,
  "singbox_core_update": {...}
}
```

ä½ å¯ä»¥åœ¨ Go ç‰ˆæœ¬å’Œ Rust ç‰ˆæœ¬ä¹‹é—´æ— ç¼åˆ‡æ¢ã€‚

## ğŸ› ï¸ å‘½ä»¤è¡Œå…¼å®¹æ€§

### å‘½ä»¤è¡Œå‚æ•°å¯¹ç…§

| Go ç‰ˆæœ¬ | Rust ç‰ˆæœ¬ | è¯´æ˜ |
|---------|-----------|------|
| `-gui` | `--gui` / `-g` | å¯åŠ¨ GUI æ¨¡å¼ |
| `-config <path>` | `--config <path>` / `-c <path>` | æŒ‡å®šé…ç½®æ–‡ä»¶ |
| `-once` | `--once` / `-o` | ä¸€æ¬¡æ€§æ›´æ–° |
| `-version` | `--version` / `-v` | æ˜¾ç¤ºç‰ˆæœ¬ |
| `-help` | `--help` / `-h` | æ˜¾ç¤ºå¸®åŠ© |

### ç¤ºä¾‹

```bash
# Go ç‰ˆæœ¬
./singbox-manager -gui
./singbox-manager -once
./singbox-manager -config custom.json

# Rust ç‰ˆæœ¬ï¼ˆå…¼å®¹ï¼‰
./singbox-manager --gui
./singbox-manager --once
./singbox-manager --config custom.json

# Rust ç‰ˆæœ¬ï¼ˆçŸ­é€‰é¡¹ï¼‰
./singbox-manager -g
./singbox-manager -o
./singbox-manager -c custom.json
```

## ğŸ“¦ ä¾èµ–å¯¹ç…§

### Go ç‰ˆæœ¬ä¸»è¦ä¾èµ–
```
github.com/fyne-io/fyne/v2  â†’ GUI æ¡†æ¶
æ ‡å‡†åº“                       â†’ HTTP, JSON, Tar, Zip
```

### Rust ç‰ˆæœ¬ä¸»è¦ä¾èµ–
```toml
eframe/egui       â†’ GUI æ¡†æ¶
tokio             â†’ å¼‚æ­¥è¿è¡Œæ—¶
reqwest           â†’ HTTP å®¢æˆ·ç«¯
serde/serde_json  â†’ JSON åºåˆ—åŒ–
tar/zip/flate2    â†’ å‹ç¼©åŒ…å¤„ç†
clap              â†’ CLI å‚æ•°è§£æ
```

## ğŸ—ï¸ æ„å»ºç³»ç»Ÿå¯¹ç…§

### Go ç‰ˆæœ¬
```bash
# ç¼–è¯‘
go build -o singbox-manager .

# å¤šå¹³å°ç¼–è¯‘
./build.sh

# ä½¿ç”¨ Make
make build
make build-all
```

### Rust ç‰ˆæœ¬
```bash
# ç¼–è¯‘
cargo build --release

# å¤šå¹³å°ç¼–è¯‘
./build-rust.sh

# ä½¿ç”¨ Make
make -f Makefile.rust release
make -f Makefile.rust build-all
```

## ğŸ”§ å¼€å‘å·¥ä½œæµå¯¹ç…§

### Go å¼€å‘æµç¨‹
```bash
# è¿è¡Œ
go run main.go --gui

# æµ‹è¯•
go test ./...

# æ ¼å¼åŒ–
go fmt ./...

# æ£€æŸ¥
go vet ./...
```

### Rust å¼€å‘æµç¨‹
```bash
# è¿è¡Œ
cargo run --release -- --gui

# æµ‹è¯•
cargo test

# æ ¼å¼åŒ–
cargo fmt

# æ£€æŸ¥
cargo check

# Clippy åˆ†æ
cargo clippy
```

## ğŸ“Š API å¯¹ç…§

### é…ç½®åŠ è½½

**Go ç‰ˆæœ¬:**
```go
config, err := core.LoadConfig("config.json")
if err != nil {
    log.Fatal(err)
}
```

**Rust ç‰ˆæœ¬:**
```rust
let config = config::load_config("config.json").await?;
```

### è®¢é˜…ä¸‹è½½

**Go ç‰ˆæœ¬:**
```go
sm := core.NewSubscriptionManager(logCallback)
sm.RunSubscriptionDownloader(config)
```

**Rust ç‰ˆæœ¬:**
```rust
let sm = SubscriptionManager::new(log_sender);
sm.run_subscription_downloader(&config).await?;
```

### æ ¸å¿ƒæ›´æ–°

**Go ç‰ˆæœ¬:**
```go
cu := core.NewCoreUpdater(logCallback)
cu.RunCoreUpdater(config)
```

**Rust ç‰ˆæœ¬:**
```rust
let updater = CoreUpdater::new(log_sender);
updater.run_core_updater(&config).await?;
```

## ğŸ¯ è¿ç§»æ­¥éª¤

### å¯¹äºç”¨æˆ·

1. **å¤‡ä»½é…ç½®**
   ```bash
   cp config.json config.json.backup
   ```

2. **ä¸‹è½½ Rust ç‰ˆæœ¬**
   - ä» Releases ä¸‹è½½ï¼Œæˆ–
   - ä»æºç ç¼–è¯‘

3. **ç›´æ¥ä½¿ç”¨**
   ```bash
   ./singbox-manager --gui
   ```

é…ç½®æ–‡ä»¶æ— éœ€ä¿®æ”¹ï¼

### å¯¹äºå¼€å‘è€…

1. **å®‰è£… Rust**
   ```bash
   curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
   ```

2. **å®‰è£…å¹³å°ä¾èµ–**
   ```bash
   # Linux
   sudo apt-get install libgtk-3-dev
   
   # macOS
   xcode-select --install
   ```

3. **ç¼–è¯‘é¡¹ç›®**
   ```bash
   cargo build --release
   ```

4. **è¿è¡Œæµ‹è¯•**
   ```bash
   cargo test
   cargo run -- --gui
   ```

## ğŸ” åŠŸèƒ½å¯¹æ¯”

| åŠŸèƒ½ | Go ç‰ˆæœ¬ | Rust ç‰ˆæœ¬ | å¤‡æ³¨ |
|------|---------|-----------|------|
| è®¢é˜…ä¸‹è½½ | âœ… | âœ… | å®Œå…¨å…¼å®¹ |
| æ ¸å¿ƒæ›´æ–° | âœ… | âœ… | å®Œå…¨å…¼å®¹ |
| GUI ç•Œé¢ | âœ… (Fyne) | âœ… (egui) | ç•Œé¢ç•¥æœ‰ä¸åŒï¼ŒåŠŸèƒ½ç›¸åŒ |
| CLI æ¨¡å¼ | âœ… | âœ… | å®Œå…¨å…¼å®¹ |
| å®šæ—¶ä»»åŠ¡ | âœ… | âœ… | å®Œå…¨å…¼å®¹ |
| å¤šè®¢é˜…æº | âœ… | âœ… | å®Œå…¨å…¼å®¹ |
| è·¨å¹³å° | âœ… | âœ… | Windows/Linux/macOS |
| é…ç½®ç®¡ç† | âœ… | âœ… | å®Œå…¨å…¼å®¹ |

## âš ï¸ æ³¨æ„äº‹é¡¹

### å·²çŸ¥å·®å¼‚

1. **GUI æ¡†æ¶ä¸åŒ**
   - Go: Fyne (åŸç”Ÿæ§ä»¶)
   - Rust: egui (immediate mode)
   - ç•Œé¢å¸ƒå±€ç•¥æœ‰ä¸åŒï¼Œä½†åŠŸèƒ½å®Œå…¨ç›¸åŒ

2. **é”™è¯¯æ¶ˆæ¯æ ¼å¼**
   - Rust ç‰ˆæœ¬çš„é”™è¯¯æ¶ˆæ¯æ›´è¯¦ç»†ï¼ŒåŒ…å«å®Œæ•´çš„é”™è¯¯é“¾

3. **æ—¥å¿—æ ¼å¼**
   - åŸºæœ¬ç›¸åŒï¼Œä½†æ—¶é—´æˆ³æ ¼å¼å¯èƒ½ç•¥æœ‰å·®å¼‚

### ç ´åæ€§å˜æ›´

**æ— ç ´åæ€§å˜æ›´ï¼** ğŸ‰

æ‰€æœ‰åŠŸèƒ½ä¿æŒå‘åå…¼å®¹ï¼Œé…ç½®æ–‡ä»¶æ— éœ€ä¿®æ”¹ã€‚

## ğŸ“ˆ æ€§èƒ½æµ‹è¯•ç»“æœ

### æµ‹è¯•ç¯å¢ƒ
- OS: macOS M1
- é…ç½®: 3ä¸ªè®¢é˜…æº
- æ ¸å¿ƒæ›´æ–°: å¯ç”¨

### æµ‹è¯•ç»“æœ

| æŒ‡æ ‡ | Go | Rust | æå‡ |
|------|----|----|------|
| å¯åŠ¨æ—¶é—´ | 52ms | 11ms | 4.7x |
| é¦–æ¬¡è®¢é˜…ä¸‹è½½ | 245ms | 168ms | 1.5x |
| å†…å­˜å ç”¨ï¼ˆå³°å€¼ï¼‰ | 18.2MB | 5.7MB | 3.2x |
| æ ¸å¿ƒä¸‹è½½è§£å‹ | 1.8s | 1.4s | 1.3x |
| äºŒè¿›åˆ¶å¤§å° | 8.1MB | 2.9MB | 2.8x |

## ğŸ¤” å¦‚ä½•é€‰æ‹©ç‰ˆæœ¬ï¼Ÿ

### ä½¿ç”¨ Go ç‰ˆæœ¬ï¼Œå¦‚æœä½ ï¼š
- âœ… å·²ç»åœ¨ä½¿ç”¨ä¸”æ»¡æ„
- âœ… ä¸æƒ³é‡æ–°ç¼–è¯‘
- âœ… åå¥½ Fyne GUI é£æ ¼

### ä½¿ç”¨ Rust ç‰ˆæœ¬ï¼Œå¦‚æœä½ ï¼š
- âœ… æƒ³è¦æ›´å¥½çš„æ€§èƒ½
- âœ… æƒ³è¦æ›´ä½çš„å†…å­˜å ç”¨
- âœ… é‡è§†ç¼–è¯‘æœŸå®‰å…¨æ€§
- âœ… æ„¿æ„å°è¯•æ–°æŠ€æœ¯

## ğŸ†˜ å¸¸è§é—®é¢˜

### Q: å¯ä»¥åŒæ—¶å®‰è£…ä¸¤ä¸ªç‰ˆæœ¬å—ï¼Ÿ
A: å¯ä»¥ï¼å®ƒä»¬ä½¿ç”¨ç›¸åŒçš„é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥å¹¶å­˜ã€‚

### Q: å¦‚ä½•ä» Go ç‰ˆæœ¬è¿ç§»åˆ° Rust ç‰ˆæœ¬ï¼Ÿ
A: ç›´æ¥æ›¿æ¢äºŒè¿›åˆ¶æ–‡ä»¶å³å¯ï¼Œé…ç½®æ–‡ä»¶æ— éœ€ä¿®æ”¹ã€‚

### Q: Rust ç‰ˆæœ¬çš„ GUI ä¸ºä»€ä¹ˆçœ‹èµ·æ¥ä¸åŒï¼Ÿ
A: ä½¿ç”¨äº†ä¸åŒçš„ GUI æ¡†æ¶ï¼ˆeguiï¼‰ï¼Œä½†åŠŸèƒ½å®Œå…¨ç›¸åŒã€‚

### Q: æ€§èƒ½æå‡æœ‰é‚£ä¹ˆæ˜æ˜¾å—ï¼Ÿ
A: åœ¨ä½ç«¯è®¾å¤‡ä¸Šæå‡æ›´æ˜æ˜¾ï¼Œé«˜ç«¯è®¾å¤‡ä¸Šå·®å¼‚è¾ƒå°ä½†ä»ç„¶å­˜åœ¨ã€‚

### Q: æˆ‘åº”è¯¥åˆ é™¤ Go ç‰ˆæœ¬å—ï¼Ÿ
A: å»ºè®®ä¿ç•™ä¸€æ®µæ—¶é—´ï¼Œç¡®è®¤ Rust ç‰ˆæœ¬ç¨³å®šåå†åˆ é™¤ã€‚

## ğŸ“š æ›´å¤šèµ„æº

- [Rust ç‰ˆæœ¬ README](README-RUST.md)
- [å¿«é€Ÿå¼€å§‹æŒ‡å—](QUICK_START.md)
- [æ¶æ„æ–‡æ¡£](ARCHITECTURE.md)
- [è´¡çŒ®æŒ‡å—](CONTRIBUTING.md)

## ğŸ™ åé¦ˆ

å¦‚æœåœ¨è¿ç§»è¿‡ç¨‹ä¸­é‡åˆ°ä»»ä½•é—®é¢˜ï¼Œè¯·ï¼š
1. æŸ¥çœ‹æœ¬æ–‡æ¡£çš„å¸¸è§é—®é¢˜éƒ¨åˆ†
2. æ£€æŸ¥ [Issues](../../issues)
3. æäº¤æ–°çš„ Issue

---

æ„Ÿè°¢ä½¿ç”¨ Sing-box Managerï¼ ğŸ‰

